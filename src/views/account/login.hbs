<div class="container flex-grow-1  d-flex justify-content-center  align-items-center ">
    <div class="card shadow-lg border-0 rounded-lg bg-light p-4 rounded  col-lg-5">
        <div class=" d-flex justify-content-center ">
            <h2 class="fw-bold">Đăng nhập</h2>
        </div>
        {{#if error_msg}}
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            {{error_msg}}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Đóng"></button>
        </div>
        {{/if}}
         {{#if success_msg}}
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            {{success_msg}}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Đóng"></button>
        </div>
        {{/if}}
        <form action="/auth/login" method="POST" id="loginForm">
            <div class=" form-floating mb-3">
                <input type="email" name="email" id="emailInput" placeholder="name@example.com" class="form-control"
                    required>
                <label for="emailInput">Email</label>
            </div>
            <div class=" form-floating mb-3">
                <input type="password" name="password" id="passwordInput" placeholder="Nhập mật khẩu" class="form-control"
                    required>
                <label for="passwordInput" class="form-label">Mật khẩu</label>
            </div>
            
            {{! Hidden input để chứa reCAPTCHA token }}
            <input type="hidden" name="g-recaptcha-response" id="g-recaptcha-response">
            
            <div class=" mb-3">
                <button type="submit" class="btn btn-primary w-100">Đăng nhập</button>
            </div>
            <div class=" mb-3 d-flex justify-content-center">
                <span class=" pe-1">Nếu bạn chưa có tài khoản,</span>
                <a href="/auth/register" class="">đăng ký tại đây</a>
            </div>
            <div class="mb-3 d-flex">
                <hr class="flex-grow-1">
                <span class="mx-2 text-muted">hoặc</span>
                <hr class="flex-grow-1">
            </div>
            <div class="row mb-3">
                <a href="/auth/google" class="btn btn-danger w-100" role="button">
                    <i class="fab fa-google me-2"></i> {{! Icon Google từ Font Awesome }}
                    Tiếp tục với Google
                </a>
            </div>


        </form>
    </div>
</div>

{{! reCAPTCHA v3 Script }}
<script src="https://www.google.com/recaptcha/api.js?render={{recaptchaSiteKey}}"></script>
<script>
    const loginForm = document.getElementById('loginForm');
    const siteKey = '{{recaptchaSiteKey}}';
    
    loginForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        grecaptcha.ready(function() {
            grecaptcha.execute(siteKey, {action: 'login'}).then(function(token) {
                // Gán token vào hidden input
                document.getElementById('g-recaptcha-response').value = token;
                // Submit form
                loginForm.submit();
            });
        });
    });
</script>